{"version":3,"sources":["body_index_calculator/utils/jsonp.cljs"],"mappings":";;;;AAUA,AAAA,AAAAA,AAAMM,AAAOC;AAAb,AAAA,AAAAN,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAC,AAAA,AAAAD,AAAA,AAAA,AAAA,AAAA,AAAAE,AAAAC,AAAAH,AAAAA;AAAA,AAAAI,AAAAJ,AAAA,AAAyBO;AAAzB,AACE,AAAMC,AAAY,AAACC;AACbC,AAAY,AAAAC,AAAQL;AAD1B,AAIE,AAAoBI,AAAMH;;AAC1B,AAAMK,AAAI,AAAA,AAAOF,AACA;AAAsBG;AAAtB,AACE,AAACC,AAAWN,AAAQ,AAAA,AAAA,AAACO,AAAQF;;AAC/B;;AAAA,AACE,AAACG,AAAaR;;;AAJjC,AAAA;AAKAA;;AAGJ","names":["p__95993","map__95994","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","body-index-calculator.utils.jsonp/jsonp","url","timeout","channel","cljs.core.async.chan.cljs$core$IFn$_invoke$arity$0","jsonp","js/goog.net.Jsonp","req","data","cljs.core.async.put_BANG_.cljs$core$IFn$_invoke$arity$2","cljs.core.js__GT_clj.cljs$core$IFn$_invoke$arity$variadic","cljs.core.async/close!"],"sourcesContent":["(ns body-index-calculator.utils.jsonp\n  (:import\n   ;; [goog.html TrustedResourceUrl]\n   ;;         [goog.string Const]\n   [goog.net Jsonp])\n  (:require-macros\n   [cljs.core.async.macros :refer [go]])\n  (:require\n   [cljs.core.async :as async]))\n\n(defn jsonp [url {:keys [timeout]}]\n  (let [channel     (async/chan)\n        jsonp       (Jsonp. url #_(->> url\n                                       Const/from\n                                       TrustedResourceUrl/fromConstant))]\n    (.setRequestTimeout jsonp timeout)\n    (let [req (.send jsonp nil\n                     (fn success-callback [data]\n                       (async/put! channel (js->clj data :keywordize-keys true)))\n                     (fn error-callback []\n                       (async/close! channel)))])\n    channel))\n\n;; example:\n(comment\n  (go (let [res (async/<! (jsonp\n                           \"http://ajaxhttpheaders.appspot.com\"\n                           {:timeout 3000}))]\n        (prn res))))\n"]}