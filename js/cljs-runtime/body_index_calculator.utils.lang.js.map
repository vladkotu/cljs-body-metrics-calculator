{"version":3,"sources":["body_index_calculator/utils/lang.cljs"],"mappings":";;;;;;;;AAWA,AAAA,AAAMA,AAAcC;AAApB,AACE,AAAIA,AACA,AAAA,AAAA,AAACC,AACDC;;AAEN,AAAA,AAAMC;AAAN,AACE,AAAMC,AAAe,AAAaC;AAAlC,AAAA,AAAA,AAAA,AAAA,AAAA,AACMC;AAKAN,AACoB,AAAA,AAACQ,AACD,AAACC,AACD,AAACC,AACD,AAACC,AAAOC,AACR,AAACC;AAJDN;AAAA,AAAM,AAAAA,AAAMH;;AADZE;AAN1B,AAYE,AAAMN;AAAN,AACE,AAACD,AAAaC;;AADhB;;;AAGJ,AAAA,AAAMc,AAA2BC,AAAQf;AAAzC,AACE,AAAM,AAAA,AAACgB,AAAqBhB;AAA5B,AACE,AAAAiB,AAAA,AAAcF,AAAQf;AAAtB,AAAA,AAAAiB,AAAAA,AAACC,AAAAA,AAAAA;;AADH;;;AAGF,AAAA,AAAMC,AAA2BJ;AAAjC,AACE,AAAAK,AAAmB,AAACjB;AAApB,AAAA,AAAAiB;AAAA,AAAAA,AAASpB;AAAT,AACE,AAACc,AAA0BC,AAAQf;;AACnC,AAAAqB,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAAC,AAAA;;AAAA,AAAA,AAAAC,AAAA,AAAAC,AAAA;AAAAC;AAAA,AAAA,AAAAC,AAAA,AAAAD,AAAA;AAAA,AAAA,AAAA,AAAAC,AAAA;AAAA,AAAAC,AAAA,AAAA;AAAAC,AAAA,AAAA;AAAAC,AAAA,AAAAC,AAAAH,AAAAC;AAAAG,AAAA,AAAA,AAAAF,AAAmBuB;AAAnB3B,AAAAA;AAAA,AAAA,AAAAO,AAAAP,AAAA,AAAAM;;AAAA,AAAA,AAAAL,AAAA;AAAA,AAAAO,AAAA,AAAAR,AAAA;AAAAS,AAAA,AAAA,AAAAD;AAAAE,AAAA,AAAAD,AAKWpC;AALXsC,AAAA,AAAAD,AAMYtB,AAA0BC;AANtCW,AAAAA;AAAA,AAAA,AAAAY,AAAAZ,AAAAW;;AAAA;;;;;AAAA,AAAA;;;;AAAA,AAAA,AAAAE,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAA,AAAAC;;AAAA,AAAAD,AAAA,AAAA;;AAAAA;;AAAAb;;AAAA,AAAA,AAAAe,AAAA,AAAA,AAAA;AAAA,AAAA,AAAAC,AAAA,AAAAjB,AAAAC;AAAA,AAAA,AAAA,AAAAiB,AAAAD,AAAA;AAAA;;AAAAA;;;;AAAA,AAAA,AAAAE,AAAAC;AAAA,AAAAC,AAAAF;AAAA,AAAA,AAAAG,AAAArB;AAAA,AAAA,AAAAqB,AAAA,AAAAD;;AAAAC;AAAA,AAAAC,AAAAtB;;AAAA;;AAAA,AAAA,AAAAkB;;;;AAAA,AAAA,AAAA,AAAAD,AAAAF,AAAA;AAAA,AAAAf;;;;AAAAe;;;;;AAAAf;;;;;AAAAA;;;;;;;;;;AAAAuB,AAAA,AAAAC,AAAA,AAAA1B,AAAAA,AAAAA;AAAA,AAAA,AAAA0B,AAAAC,AAAA,AAAA9B;;AAAA6B;;AAAA,AAAA,AAAAE,AAAAH;;;;AAAA5B;;;AAQJ,AAAA,AAAMiC,AAAuBC;AAA7B,AACE,AAAMC,AAAK,AAAC3C,AAAM,AAAC4C,AAAU,AAAA,AAACC;AAA9B,AACE,AAAA,AAAeF,AAAY,AAACG,AAAKJ","names":["body-index-calculator.utils.lang/lang-keyword","lang-code","cljs.core.subs.cljs$core$IFn$_invoke$arity$3","cljs.core.keyword.cljs$core$IFn$_invoke$arity$1","body-index-calculator.utils.lang/get-nav-lang!","nav","js/window","lang-nav-props","p1__95997#","cljs.core.map.cljs$core$IFn$_invoke$arity$2","cljs.core.js__GT_clj.cljs$core$IFn$_invoke$arity$1","cljs.core/flatten","cljs.core.remove.cljs$core$IFn$_invoke$arity$2","cljs.core/nil?","cljs.core/first","body-index-calculator.utils.lang/dispatch-supported-locale","ev-name","cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2","G__95998","re-frame.core/dispatch","body-index-calculator.utils.lang/put-detect-lang-to-store!","temp__5733__auto__","c__61781__auto__","cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1","cljs.core.async.impl.dispatch/run","f__61782__auto__","switch__61678__auto__","state_96009","state_val_96010","inst_95999","inst_96000","inst_96001","cljs.core/PersistentHashMap","inst_96002","cljs.core.async.impl.ioc-helpers/take!","inst_96004","inst_96005","inst_96006","inst_96007","cljs.core.async.impl.ioc-helpers/return-chan","statearr-96011","state-machine__61679__auto__","ret-value__61680__auto__","result__61681__auto__","cljs.core/keyword-identical?","e96012","js/Object","ex__61682__auto__","statearr-96013","cljs.core.async.impl.ioc-helpers/process-exception","state__61783__auto__","statearr-96014","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","body-index-calculator.utils.jsonp/jsonp","body-index-calculator.utils.lang/write-html-lang-attr!","locale","html","cljs.core.array_seq.cljs$core$IFn$_invoke$arity$1","goog.dom/getElementsByTagName","cljs.core/name"],"sourcesContent":["(ns body-index-calculator.utils.lang\n  (:require-macros\n   [cljs.core.async.macros :refer [go]])\n  (:require\n   [goog.dom :as dom]\n   [re-frame.core :as rf]\n   [cljs.spec.alpha :as s]\n   [body-index-calculator.db :as db]\n   [body-index-calculator.utils.jsonp :refer [jsonp]]\n   [cljs.core.async :as async :refer [<!]]))\n\n(defn lang-keyword [lang-code]\n  (-> lang-code\n      (subs 0 2)\n      keyword))\n\n(defn get-nav-lang! []\n  (let [nav            (.-navigator js/window)\n        lang-nav-props [\"languages\"\n                        \"language\"\n                        \"browserLanguage\"\n                        \"systemLanguage\"\n                        \"userLanguage\"]\n        lang-code      (->> lang-nav-props\n                            (map #(aget nav %))\n                            (js->clj)\n                            (flatten)\n                            (remove nil?)\n                            (first))]\n    (when lang-code\n      (lang-keyword lang-code))))\n\n(defn dispatch-supported-locale [ev-name lang-code]\n  (when (s/valid? ::db/locale lang-code)\n    (rf/dispatch [ev-name lang-code])))\n\n(defn put-detect-lang-to-store! [ev-name]\n  (if-let [lang-code (get-nav-lang!)]\n    (dispatch-supported-locale ev-name lang-code)\n    (go (let [res (<! (jsonp\n                       \"http://ajaxhttpheaders.appspot.com\"\n                       {:timeout 3000}))]\n          (->> res\n               :Accept-Language\n               lang-keyword\n               (dispatch-supported-locale ev-name))))))\n\n(defn write-html-lang-attr! [locale]\n  (let [html (first (array-seq (dom/getElementsByTagName \"html\")))]\n    (.setAttribute html \"lang\" (name locale))))\n"]}